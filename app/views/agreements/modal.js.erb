var title       =   '.modal-title',
    loader      =   '.ajax-loader',
    content     =   '.modal-body-content',
    toolbar     =   'div.modal-footer';
    modal       =   '#ajax-modal'

$(loader).fadeToggle('fast', function() {
  <% if @agreement.buyer_id != 0 and @agreement.producer_id != 0 %>

    $(title).html("Completed Agreement");
    $(content).show().html("<%= j render partial: 'modal/completed' %>");

  <% elsif @agreement.buyer_id != 0 %>

    $(title).html("<%= j @agreement.buyer.buyer_profile.name %>");
    $(content).show().html("<%= j render partial: 'modal/buyer' %>");

    <% if @agreement.buyer_id != current_user.id %>
      $(toolbar).html("<%= j (link_to raw('<i class="icon-edit"></i> Propose Amendments'), discuss_agreement_path, class: "btn") + " " + (link_to raw('<i class="icon-ok icon-white"></i> Accept Agreement'), accept_agreement_path(@agreement, producer_id: current_user.id), method: "put", confirm: "You will be obligated to fulfill your part of the contract", class: "btn btn-warning") %>")
    <% end %>

  <% elsif @agreement.producer_id != 0 %>

    $(title).html("<%= j @agreement.producer.producer_profile.name %>");
    $(content).show().html("<%= j render partial: 'modal/producer' %>");

    <% if @agreement.producer_id != current_user.id %>
      $(toolbar).html("<%= j (link_to raw('<i class="icon-edit"></i> Propose Amendments'), discuss_agreement_path, class: "btn") + " " + (link_to raw('<i class="icon-ok icon-white"></i> Accept Agreement'), accept_agreement_path(@agreement, buyer_id: current_user.id), method: "put", confirm: "You will be obligated to fulfill your part of the contract", class: "btn btn-warning") %>")
    <% end %>

  <% end %>

  $('#content').append('<%= j render partial: "partials/stack2modal" %>');

  $(modal).modal();
});

