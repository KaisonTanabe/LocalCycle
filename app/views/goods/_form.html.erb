<%= semantic_form_for(@good, html: { multipart: true, class: "form-horizontal" }) do |f| %>

  <legend></legend>
  <%= render partial: 'partials/errors', locals: {obj: @good} %>

  <div class="control-group">
    <%= f.label :available, "Available:", class: "control-label" %>
    <div class="controls-row controls">
      <label class="checkbox"><%= f.input :available %></label>
    </div>
  </div>

  <div class="control-group">
    <%= f.label :certifications, "Certifications:", class: "control-label" %>
    <div class="row-fluid">
			<div class="controls-row controls">
				<div class="span6">
				<%Certification.all.each_with_index do |cer, i|%>
					<%= "</div><div class=\"span6\">".html_safe if i== 15 %>
					<%= check_box_tag "good[certification_ids][]", cer.id, @good.certifications.include?(cer)%>
		 
			  	<%= cer.name%><br/>
				<%end%>
				</div>
			</div>
    </div>
  </div>
	<% if !current_user.buyer? && !current_user.producer?%>

  <div class="control-group">
    <%= f.label :product_id, "Product:", class: "control-label" %>
    <div class="controls-row controls">
      <%= f.select :product_id, option_groups_from_collection_for_select(Category.includes(:products).order('name'), :products, :name, :id, :name, (params[:product_id].blank? ? (@good.product ? @good.product.id : "") : params[:product_id])), {prompt: "-- Select Product --"}, {class: "select2 span4" } %>
    </div>
  </div>

  <% if current_user.market_manager? or current_user.admin? %>
  <div class="control-group">
    <%= f.label :producer_id, "Producer:", class: "control-label" %>
    <div class="controls-row controls">
      <%= f.select :creator_id, options_from_collection_for_select(User.by_producer.order('name'), :id, :name, (params[:creator_id].blank? ? (@good.creator ? @good.creator.id : "") : params[:creator_id])), {prompt: "-- Select Producer --"}, {class: "select2 span4" } %>
    </div>
  </div>
  <% else %>
    <%= f.hidden_field :creator_id, value: current_user.id %>
  <% end %>
  
  

  <div class="control-group">
    <%= f.label :quantity, "Quantity:", class: "control-label" %>
    <div class="controls-row controls">
      <%= f.number_field :quantity, placeholder: "Qty", class: "span2" %>
      <%= f.select :selling_unit_id, SellingUnit.all.map {|s| [s.name, s.id]}, {prompt: "Unit"}, {class: "span2"} %>
    </div>
  </div>

  <div class="control-group">
    <%= f.label :price_points, "Price Points:", class: "control-label" %>

		<div class="span4">
   	 <%= f.fields_for :price_points do |fpp| %>
	      <%= render partial: 'price_points/form', locals: { f: fpp, good: @good } %>
	      <%= new_child_fields_template(f, :price_points, {partial: "price_points/batch_form"})%>
	    <% end %>

	    <div class="controls span4" style="margin-left: 0px">
	      <span class="help-inline" ><%= add_child_link "Price Point", :price_points %></span>
	    </div>

		</div>
  </div><br/>
<%end%>
	<div class="controls-group">
    <%= f.label :description, "Description:", class: "control-label" %>
    <div class="control-row controls">
      <%= f.text_area :description, rows: 5, cols: 40 %>
    </div>
  </div>
 <br/>

	<% if !current_user.buyer? %>
  
	<div class="control-group">
    <label class="control-label">Thumbnail:</label>
    <% if !f.object.new_record? %>
      <div class="controls controls-row child-field" style="padding: 5px;" >
				<% if !f.object.pic.url.match(/missing.png/) %>
					<%= image_tag f.object.pic.url(:medium) %>      	
				<%else%>
        	<%= image_tag f.object.product.best_pic_url(:medium) %>
				<%end%>
      </div>
    <% end %>
    <div class="controls control-row">
      <%= f.file_field :pic, class: "span4" %>
      <span class="help-block">Upload an pic to use instead of the default. 2MB Limit.</span>
    </div>
  </div>

	
  <div class="controls-group">
    <%= f.label :order_cutoff, "Order Cutoff:", class: "control-label" %>
    <div class="control-row controls">
			<%=f.number_field :order_cutoff%> Hours
		</div>
	</div>
	<br/><br/>
  <div class="controls-group">
    <%= f.label :start_date, "Duration:", class: "control-label" %>
    <div class="control-row controls">
      <%= f.text_field :start_date, placeholder: "First delivery", data: {behavior: "datepicker"}, class: "span2 datepicker" %>
      <%= f.text_field :end_date, placeholder: "Last delivery", data: {behavior: "datepicker"}, class: "span2 datepicker", style: "margin-left: 30px;" %>
    </div>
  </div>
    <%end%>
  <hr style="clear: both;" />
  
	<% if current_user.buyer?%>
  	<%= render partial: 'partials/submit', locals: {f: f, text: 'Wishlist' } %>
	<%else%>
  	<%= render partial: 'partials/submit', locals: {f: f, text: 'Supply' } %>
	<%end%>
	
<% end %>
