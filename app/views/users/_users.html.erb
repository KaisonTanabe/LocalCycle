<% if @users.any? %>
  <% @users.each do |user| %>
    <%= content_tag_for :tr, user do %>
      <td class='role <%= (params[:sort] == "role") ? "sorted" : "" %>'>
	<%= user.role %>
      </td>
      <td class='name <%= (params[:sort] == "last_name") ? "sorted" : "" %>'>
	<%= link_to(user.formal_name, edit_user_path(user)) %>
      </td>

      <td class='name <%= (params[:sort] == "last_name") ? "sorted" : "" %>'>
	<%= user.producer_profile.name if user.producer? and user.producer_profile %>
	<%= user.buyer_profile.name if user.buyer? and user.buyer_profile %>
      </td>

      <td class='login <%= (params[:sort] == "current_sign_in_at") ? "sorted" : "" %>'>
        <%= user.current_sign_in_at ? user.current_sign_in_at.strftime("%b %-d %I:%M %P") : "Never" %>
      </td>
      <td>
	<%= render partial: "users/buttons", locals: {user: user} %>
      </td>
    <% end %>
  <% end %>
<% else %>
  <tr><td colspan="4"><em>No matching users...</em></td></tr>
<% end %>
